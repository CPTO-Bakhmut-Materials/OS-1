#  Bash: Параметри (Bash Parameters)

Параметри в Bash — це іменовані області пам'яті, які використовуються для зберігання та отримання інформації. Зазвичай вони зберігають рядкові (string) дані, але також можуть містити цілі числа або масиви.

Параметри бувають двох видів: **змінні (variables)** та **спеціальні параметри (special parameters)**. Спеціальні параметри доступні лише для читання і встановлюються самим Bash для передачі внутрішнього статусу. Змінні ж можна створювати та змінювати самостійно.

### Присвоєння значень

Для збереження даних у змінній використовується синтаксис присвоєння. **Важливо:** навколо знака `=` не повинно бути пробілів!

```bash
# Правильно:
my_var="Hello World"

# Неправильно (Bash подумає, що my_var — це команда, а = і "Hello World" - її аргументи):
my_var = "Hello World"
```

---

## Спеціальні параметри та змінні

Спеціальні параметри дозволяють отримувати інформацію про стан скрипта, передані аргументи чи результати виконання команд. На відміну від деяких інших мов (наприклад, PHP), імена самих змінних не починаються з `$`. Символ `$` вказує оболонці на **розгортання (expansion)** — заміну параметра на його вміст.

| Параметр | Використання | Опис |
| --- | --- | --- |
| `0` | `"$0"` | Ім'я або шлях до поточного скрипта (не завжди надійне джерело). |
| `1`, `2`... | `"$1"`, `"$2"` | Позиційні параметри (аргументи), передані поточному скрипту або функції. |
| `*` | `"$*"` | Усі позиційні параметри у вигляді єдиного рядка (слова розділяються першим символом змінної `IFS`). |
| `@` | `"$@"` | Усі позиційні параметри. У подвійних лапках розгортається як список окремих слів (найкращий вибір для циклів). |
| `#` | `"$#"` | Кількість позиційних параметрів (аргументів), які наразі встановлено. |
| `?` | `"$?"` | Код завершення (exit code) останньої виконаної команди на передньому плані. |
| `$` | `"$$"` | PID (ідентифікатор процесу) поточної оболонки. |
| `!` | `"$!"` | PID останньої команди, виконаної у фоновому режимі. |
| `_` | `"$_"` | Останній аргумент останньої виконаної команди. |

### Приклади для закріплення:

```bash
#!/bin/bash
# Якщо зберегти це як script.sh і запустити: ./script.sh ubuntu debian

echo "Назва скрипта: $0"           # Виведе: ./script.sh
echo "Перший аргумент: $1"        # Виведе: ubuntu
echo "Всього аргументів: $#"      # Виведе: 2

# Безпечний перебір усіх аргументів:
for os in "$@"; do
    echo "Обробляється ОС: $os"
done

# Перевірка на успішність виконання:
ping -c 1 google.com > /dev/null 2>&1
if [ $? -eq 0 ]; then
    echo "Мережа працює! (Код завершення: $?)"
else
    echo "Помилка мережі!"
fi

```

---

## Типи змінних

Хоча Bash не є строго типізованою мовою, він підтримує кілька "типів", які визначають, який контент може зберігати змінна. Для оголошення використовується вбудована команда `declare`.

* **Масив (Array):** `declare -a my_array` — Змінна є списком рядків, що індексується числами. (Зазвичай достатньо просто написати `my_array=(...)`).
* **Асоціативний масив (Associative array):** `declare -A my_dict` — Словник типу "ключ-значення" (доступно з Bash 4.0+). Обов'язково потребує явного оголошення.
* **Ціле число (Integer):** `declare -i my_num` — Автоматично тригерить арифметичні обчислення при присвоєнні.
* **Тільки для читання (Read Only):** `declare -r my_const` — Змінну більше не можна змінити або видалити (unset).
* **Експортована (Export):** `declare -x my_env` — Змінна помічається для експорту, тобто успадковується всіма дочірніми процесами (змінна оточення).

### Приклади для закріплення:

```bash
# 1. Індексовані масиви
servers=("web01" "db01" "cache01")
echo "Перший сервер: ${servers[0]}"
echo "Усі сервери: ${servers[@]}"

# 2. Асоціативні масиви (потребує declare -A)
declare -A ports
ports[http]=80
ports[https]=443
echo "Порт для HTTPS: ${ports[https]}"

# 3. Цілочисельна математика
declare -i counter=10
counter+=5 # Працює автоматично завдяки declare -i
echo "Лічильник: $counter" # Виведе 15

# Без declare -i результат був би рядковим: "105"

```

---

## Розгортання параметрів (Parameter Expansion)

Розгортання параметрів — це будь-яка операція, яка змушує параметр розгорнутися (замінитися на свій вміст). Базова форма — це префікс `$`. В деяких ситуаціях потрібні фігурні дужки `${}`, щоб Bash міг чітко зрозуміти, де закінчується ім'я змінної.

Завжди **використовуйте подвійні лапки** навколо розгортань (напр., `"$file"`). Це запобігає непередбачуваному розбиттю на слова (Word Splitting), якщо значення містить пробіли.

### Операції зі значеннями за замовчуванням

| Синтаксис | Опис |
| --- | --- |
| `${var:-word}` | **Використати за замовчуванням:** Якщо `var` порожня/не встановлена, підставляється `word`. Сама змінна `var` не змінюється. |
| `${var:=word}` | **Присвоїти за замовчуванням:** Якщо `var` порожня, їй *присвоюється* `word`, і це значення підставляється. |
| `${var:+word}` | **Альтернативне значення:** Якщо `var` має значення, підставляється `word` (інакше нічого). |

### Обрізання та маніпуляції з рядками

| Синтаксис | Опис |
| --- | --- |
| `${var:offset:length}` | **Підрядок:** Отримує `length` символів, починаючи з позиції `offset`. |
| `${#var}` | **Довжина:** Повертає кількість символів у змінній. |
| `${var#pattern}` | Видаляє **найкоротший** збіг `pattern` з **початку** рядка. |
| `${var##pattern}` | Видаляє **найдовший** збіг `pattern` з **початку** рядка. |
| `${var%pattern}` | Видаляє **найкоротший** збіг `pattern` з **кінця** рядка. |
| `${var%%pattern}` | Видаляє **найдовший** збіг `pattern` з **кінця** рядка. |
| `${var/pattern/repl}` | Замінює перше входження `pattern` на `repl`. |
| `${var//pattern/repl}` | Замінює всі входження `pattern` на `repl`. |

### Приклади для закріплення:

```bash
# --- Замовчувані значення ---
TARGET_DIR=${1:-"/tmp/default_backup"}
echo "Резервне копіювання до: $TARGET_DIR"

# --- Обрізання рядків (часто використовується зі шляхами) ---
full_path="/var/www/html/index.nginx.html"

# Видалення всього до останнього '/' (отримання імені файлу)
filename="${full_path##*/}"
echo "Файл: $filename"          # index.nginx.html

# Отримання директорії (видалення від кінця до останнього '/')
directory="${full_path%/*}"
echo "Каталог: $directory"      # /var/www/html

# Видалення розширення (від кінця до останньої крапки)
name_only="${filename%.*}"
echo "Без розширення: $name_only" # index.nginx

# --- Заміна тексту ---
status="Сервер зупинено"
echo "${status/зупинено/працює}"  # Виведе: Сервер працює

```